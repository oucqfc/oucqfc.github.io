<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="所有人都在努力，并不是只有你满腹委屈">
<meta property="og:type" content="website">
<meta property="og:title" content="FangChao.Qu Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="FangChao.Qu Blog">
<meta property="og:description" content="所有人都在努力，并不是只有你满腹委屈">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FangChao.Qu Blog">
<meta name="twitter:description" content="所有人都在努力，并不是只有你满腹委屈">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title> FangChao.Qu Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">FangChao.Qu Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/29/activiti/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FangChao.Qu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiangImg.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FangChao.Qu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/29/activiti/" itemprop="url">
                  Activiti工作流(第一天)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-29T09:26:46+08:00">
                2017-06-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-安装流程设计器"><a href="#1-安装流程设计器" class="headerlink" title="1.安装流程设计器"></a>1.安装流程设计器</h1><ol>
<li>将activiti-designer.zip解压到myeclipse安装目录下的dropins下的activiti-designer文件夹</li>
<li>创建activiti.link文件，内容如下</li>
<li><p>注意：打开菜单Windows-&gt;Preferences-&gt;Activiti-&gt;Save actions， 把<em>bpmn 和</em>.png同步保存</p>
<p> path=C:\Users\qfc\AppData\Local\MyEclipse Professional 2014\dropins\activiti-designer\</p>
<h1 id="2-Activiti介绍"><a href="#2-Activiti介绍" class="headerlink" title="2.Activiti介绍"></a>2.Activiti介绍</h1><ol>
<li>工作流引擎 ：ProcessEngine ，它是Activiti的核心类，由该类可以获取其他的服务实例<pre><code>（历史服务、仓库服务、任务服务、用户参与者服务）
</code></pre></li>
<li>BPMN  ：UML ：用例图、类图、时序图<br> 业务流程建模与标注（Business Process Model and Notation，BPMN) ，<br> 描述流程的基本符号，包括这些图元如何组合成一个业务流程图（Business Process Diagram）</li>
<li><p>数据库<br> Activiti的后台是有数据库的支持，所有的表都以ACT_开头。<br> 第二部分是表示表的用途的两个字母标识。 用途也和服务的API对应<br> Activiti的工作流数据库有23张表<br>   要保存流程定义 </p>
<pre><code>- act_ge_*  ：通用表
</code></pre><ul>
<li>act<em>hi</em>*  ：历史流程相关表 </li>
<li>act<em>re</em>*  ：仓库表：保存流程定义</li>
<li>act<em>ru</em>*  ：保存流程运行相关的表  </li>
<li>act<em>id</em>*  ：用户参与相关的表  </li>
</ul>
</li>
<li><p>activiti.cfg.xml<br>  Activiti核心配置文件，配置流程引擎创建工具的基本参数和数据库连接参数</p>
<h1 id="3-HelloActiviti程序（模拟Activiti流程执行）"><a href="#3-HelloActiviti程序（模拟Activiti流程执行）" class="headerlink" title="3.HelloActiviti程序（模拟Activiti流程执行）"></a>3.HelloActiviti程序（模拟Activiti流程执行）</h1></li>
<li><p>设置流程定义图bpmn<br>assignee :代理人、指定人、处理人</p>
</li>
<li><p>创建流程引擎及工作流数据表</p>
<p>数据库及表可以自动创建，</p>
<p> 可以在配置数据库连接时，实现自动创建数据库和表</p>
<p>取得ProcessEngine对象</p>
<p> 先取得ProcessEngineConfiguration 对象 ，再由该对象来构建ProcessEngine</p>
</li>
</ol>
</li>
</ol>
<ol>
<li><p>部署流程<br> 影响的表：</p>
<p> act_re_procdef ：流程定义表 ：</p>
<p> 该表的key属性 是bpmn 的 id决定  </p>
<p> 该表的name属性  是bpmn 的name 属性决定</p>
<p> act_re_deployment：部署表 ：id是由act_ge_property的 next_dbid决定</p>
<p> act_ge_property ：通用属性表</p>
</li>
<li><p>启动流程</p>
</li>
<li><p>查看我的个人任务</p>
</li>
<li>完成我的个人任务</li>
</ol>
<h1 id="4-代码"><a href="#4-代码" class="headerlink" title="4.代码"></a>4.代码</h1><pre><code>public class TestActiviti {
    ProcessEngine engine=ProcessEngines.getDefaultProcessEngine();

    @Test
    // 取得流程引擎，且自动创建Activiti设计的数据库及表
    public void createProcessEngine() {
        /*方法一
        // 取得ProcessEngineeConfiguration对象
        ProcessEngineConfiguration engineConfiguration = ProcessEngineConfiguration
                .createStandaloneProcessEngineConfiguration();
        // 设置数据库库连接属性
        engineConfiguration.setJdbcDriver(&quot;com.mysql.jdbc.Driver&quot;);
        engineConfiguration
                .setJdbcUrl(&quot;jdbc:mysql://localhost:3306/activitiDB?createDatabaseIfNotExist=true&quot;
                        + &quot;&amp;useUnicode=true&amp;characterEncoding=utf8&quot;);
        engineConfiguration.setJdbcUsername(&quot;root&quot;);
        engineConfiguration.setJdbcPassword(&quot;21160233099&quot;);
        // 设置创建表的策略（当没有表时，自动创建表）
        // public static final java.lang.String DB_SCHEMA_UPDATE_FALSE =
        // &quot;false&quot;;
        // public static final java.lang.String DB_SCHEMA_UPDATE_CREATE_DROP =
        // &quot;create-drop&quot;;
        // public static final java.lang.String DB_SCHEMA_UPDATE_TRUE = &quot;true&quot;;
        engineConfiguration.setDatabaseSchemaUpdate(&quot;true&quot;);
        // 通过ProcessEngineConfiguration对象常见ProcessEnginee对象
        ProcessEngine processEngine = engineConfiguration.buildProcessEngine();
 */
        //方法二
            //ProcessEngineConfiguration engineConfiguration=ProcessEngineConfiguration.createProcessEngineConfigurationFromResource(&quot;activiti.cfg.xml&quot;);
            //ProcessEngine engine=engineConfiguration.buildProcessEngine();
        //方法三
        ProcessEngine processEngine=ProcessEngines.getDefaultProcessEngine();//默认必须是activiti.cfg.xml方法二可以随意改名

    }
    //部署流程定义
    @Test
    public void deploy(){
        //取得流程引擎
        //获取仓库服务：管理流程定义
        RepositoryService repositoryService=engine.getRepositoryService();
        repositoryService.createDeployment()//创建一个部署的构建器
        .addClasspathResource(&quot;diagrams/LeaveBill.bpmn&quot;)//从类路径添加资源
        .addClasspathResource(&quot;diagrams/LeaveBill.png&quot;)
        .name(&quot;请假单流程&quot;)//设置部署名称
        .category(&quot;办公类别&quot;)//设置部署的类别
        .deploy();
    }
    //执行流程
    @Test
    public void startProcess(){
        String processKey=&quot;leaveBill&quot;;
        //取运行时服务
        RuntimeService runtimeService=engine.getRuntimeService();
        //取得流程实例
        ProcessInstance pi=runtimeService.startProcessInstanceByKey(processKey);//通过流程定义的key来执行流程
        System.out.println(pi.getId()+pi.getProcessDefinitionId());
    }
    //查询任务
    @Test
    public void queryTask(){
        String name=&quot;李四&quot;;
        //取得任务服务
        TaskService taskService=engine.getTaskService();
        //创建一个任务查询对象
        TaskQuery query=taskService.createTaskQuery();
        //办理人的任务列表
        List&lt;Task&gt; list=query.taskAssignee(name).list();
        for(Task task:list){
            System.out.println(task.getAssignee()+&quot; &quot;+task.getId());

        }
    }
    @Test
    //完成任务
    public void complete(){
        String taskID=&quot;204&quot;;
        engine.getTaskService().complete(taskID);


    }
}
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/26/linux2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FangChao.Qu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiangImg.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FangChao.Qu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/26/linux2/" itemprop="url">
                  linux基础操作2
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-26T09:26:46+08:00">
                2017-06-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-网络管理"><a href="#1-网络管理" class="headerlink" title="1.网络管理"></a>1.网络管理</h1><p>修改ip地址的配置</p>
<p>sudo vi /etc/sysconfig/network-scripts/ifcfg-eth0 修改该配置文件即可改ip地址</p>
<p>或者在root权限下用setup指令通过一个带提示的伪图形界面来修改</p>
<p>查看ip地址<br>ifconfig</p>
<p>修改主机名</p>
<p>sudo vi  /etc/sysconfig/network  </p>
<p>修改其中的hostname配置项</p>
<p>要想立即生效  可以执行指令  hostname nidezhujiming </p>
<p>HOSTNAME=yun12-01</p>
<p>管理内网的”主机名—ip地址”本地映射</p>
<p>sudo vi /etc/hosts</p>
<p>192.168.2.250  yun12-01</p>
<p>重启网络服务</p>
<p>root权限下   service network restart </p>
<p>关闭防火墙服务  service iptables stop</p>
<p>关闭防火墙自动启动   chkconfig iptables off</p>
<p>修改系统的默认启动级别</p>
<p>vi /etc/inittab</p>
<pre><code>  0 - halt (Do NOT set initdefault to this)
 1 - Single user mode
2 - Multiuser, without NFS (The same as 3, if you do not have networking)
3 - Full multiuser mode
4 - unused
 5 - X11
 6 - reboot (Do NOT set initdefault to this)
</code></pre><p>id:3:initdefault:<br>~<br>用level 3 就启动全功能状态的字符界面 </p>
<p>查看当前的进程连接网络的信息</p>
<p>netstat -nltp   </p>
<h1 id="2-常用工具指令"><a href="#2-常用工具指令" class="headerlink" title="2.常用工具指令"></a>2.常用工具指令</h1><p>wc   统计文本信息（行数，词数，字符数）</p>
<p>date  查看或者修改系统的日期和时间</p>
<p>echo  输出字符串或者变量的值</p>
<p>vi   linux系统中最通用的文本编辑器</p>
<h1 id="3-linux中的软件安装"><a href="#3-linux中的软件安装" class="headerlink" title="3.linux中的软件安装"></a>3.linux中的软件安装</h1><p> ##3.1 安装jdk</p>
<pre><code> 实现步骤：
  1. jdk 存放在哪里  /opt
  2. 把软件拷贝到/opt
  3. 绿色软件，解压 
  4.设置环境变量
  vim /etc/profile 
  export JAVA_HOME=&quot;/java/jdk1.6.0_39&quot;
  export PATH=$PATH:$JAVA_HOME/bin
刷新配置 ，让配置生效
 source /etc/profile  （java -version失效，可重复此操作）
编写Demo.java,测试 
 -javac Demo.java
     - java Demo
</code></pre><p>##3.2. 安装tomcat<br>       步骤：</p>
<pre><code> 2. 拷贝、解压
tar -xzvf  apache-tomcat.tar.gz
 3. 运行
- ./startup.sh
- ./shutdown.sh
</code></pre><p> ##3.3 安装Eclipse<br>       步骤：</p>
<pre><code>拷贝、解压
 cp eclipse.tar.gz  /opt
 tar -xzvf  eclipse.tar.gz 
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/21/linux1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FangChao.Qu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiangImg.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FangChao.Qu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/21/linux1/" itemprop="url">
                  linux基础操作1
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-21T09:26:46+08:00">
                2017-06-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-文件系统的管理"><a href="#1-文件系统的管理" class="headerlink" title="1.文件系统的管理"></a>1.文件系统的管理</h1><p>tips:输入命令的时候要常用tab键来补全</p>
<p>ls   查看目录信息  （ ls /  ）<br>    ls -l 等价于  ll<br>pwd      查看当前所处的路径   </p>
<pre><code>cd     切换目录 (cd /) ,如果不带参数则切换到用户主目录 ~
</code></pre><p>mkdir   创建文件夹</p>
<pre><code>mkdir -p a/b/c  如果要创建的文件夹的父目录不存在，则自动创建
</code></pre><p>rmdir   删除空文件夹  (只能删除空文件夹)</p>
<pre><code>rm -r  /a/b  (删除非空文件夹)
</code></pre><p>创建文件</p>
<pre><code>touch a.avi 创建一个空文件

vi blabla.txt 用文本编辑器编辑一个文件并且保存

echo &quot;angelababy,zhen de hen xihuan ni&quot; &gt; qingshu.txt  把左边的输出放到右边的文件里去 
</code></pre><p>删除文件</p>
<pre><code>rm filename  (rm -r  删除文件夹     rm -rf 强制删除文件或文件夹)
</code></pre><p>移动文件  修改文件名</p>
<pre><code>mv a/wenjian1.txt b/file1.txt   (移动文件的同时还修改了文件名)
</code></pre><p>拷贝文件</p>
<pre><code>cp srcFile destFile
</code></pre><p>查看文本文件内容</p>
<pre><code>cat wodeqingshu.txt

more wodeqingshu.txt 可以分页看

less wodeqingshu.txt 不仅可以分页，还可以方便地搜索，回翻等操作

tail -10 wodeqingshu.txt   查看文件的尾部的10行
</code></pre><p>程序打出的日志在生产实践中具有非凡的debug的意义</p>
<pre><code>tail -f user.log   实时刷新显示文件的尾部

head -20 wodeqingshu.txt 查看文件的头部20行
</code></pre><h1 id="2-权限管理"><a href="#2-权限管理" class="headerlink" title="2.权限管理"></a>2.权限管理</h1><p>linux系统中对文件权限的描述机制：</p>
<pre><code>d  r  w  x   r  w  x   r  -  x

   所有者      所属组    其他人

可以表示为二进制：  111 111 101

也可以表示为十进制： 7     7   5
</code></pre><p>修改权限<br>    chmod  u+rwx file   为file添加或取消所属用户的权限</p>
<pre><code>(u代表所属用户  o代表其他用户  g代表所属组的成员用户)

chmod 567 file 用数字也可以表示权限  
</code></pre><p>修改文件的所有者owner（只能由root权限才能操作）</p>
<pre><code>chown hadoop:hadoop  file 将file的所有者改成hadoop用户，所属组改成hadoop组

上级目录的权限对本级文件或者文件夹的操作有约束
</code></pre><h1 id="3-用户管理"><a href="#3-用户管理" class="headerlink" title="3.用户管理"></a>3.用户管理</h1><p>添加用户</p>
<pre><code>useradd  qfc

必须设置密码才能正常登陆    passwd qfc

在/home/下：mkdir qfc

chown qfc:qfc qfc

cp .bash_history .bashrc qfc
</code></pre><p>删除用户</p>
<pre><code>userdel yun12

userdel -r itcast -----删除用户的同时删除用户的主目录
</code></pre><p>修改用户属性</p>
<pre><code>usermod -l b a 将a的登陆名改为b

usermod -g hadoop itcast0830 将itcast0830的组改为hadoop组

usermod -G hadoop,root itcast0830 给itcast0830添加两个组hadoop,root

usermod -d /home/itcast itcast0830 将itcast0830的主目录改成/home/itcast

（要事先创建itcast目录，并且拷入环境变量文件）
</code></pre><p>—-<em>**</em>—-修改用户的密码</p>
<pre><code>passwd itcast0830
</code></pre><p>添加用户组<br>    groupadd beauties</p>
<p>删除用户组<br>    groupdel beauties</p>
<p>修改用户组属性<br>    groupmod </p>
<p>查看当前登陆的身份<br>    whoami<br>查看当前用属的组<br>    groups</p>
<h1 id="4-常见系统管理-凡是涉及到修改，就一定要用root权限"><a href="#4-常见系统管理-凡是涉及到修改，就一定要用root权限" class="headerlink" title="4.常见系统管理(凡是涉及到修改，就一定要用root权限)"></a>4.常见系统管理(凡是涉及到修改，就一定要用root权限)</h1><hr>
<p>轻易不要使用su去切换到root的身份</p>
<p>普通用户使用sudo来执行root权限的命令</p>
<p>如，将hadoop用户添加到sudoers文件中去</p>
<pre><code>root    ALL=(ALL)       ALL

hadoop  ALL=(ALL)       ALL
</code></pre><p>磁盘空间信息查看</p>
<pre><code>df -h  查看磁盘空间状态信息

du -sh * 查看当前目录下所有子目录和文件的汇总大小    
</code></pre><p>进程信息查看 </p>
<pre><code>free  查看内存使用状况

top   查看实时刷新的系统进程信息

ps -ef  查看系统中当前瞬间的进程信息快照


ps -ef | grep myshell.sh  搜索myshell进程的信息

kill -9 pid  杀掉进程  （-9 表示强制杀死）
</code></pre><h1 id="5-文件归档压缩-1：打包–归档；-2：压缩"><a href="#5-文件归档压缩-1：打包–归档；-2：压缩" class="headerlink" title="5.文件归档压缩(1：打包–归档； 2：压缩)"></a>5.文件归档压缩(1：打包–归档； 2：压缩)</h1><ol>
<li>归档与解档<br> tar -cvf testdir.tar testdir/<br> tar -xvf testdir.tar </li>
<li><p>压缩<br> gzip testdir.tar  </p>
<p> gzip  file</p>
<p> bzip  file </p>
<p> tar -czvf  testdir.tar.gz testdir/</p>
<p> tar -xzvf testdir.tar.gz  解压到当前目录下</p>
<p> tar -zxvf testdir.tar.gz -C Downloads/   解压到指定的Downloads目录下</p>
</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/21/jk10/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FangChao.Qu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiangImg.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FangChao.Qu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/21/jk10/" itemprop="url">
                  基于SSM的商贸平台项目（第十天）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-21T09:26:46+08:00">
                2017-06-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-数据库总结"><a href="#1-数据库总结" class="headerlink" title="1.数据库总结"></a>1.数据库总结</h1><h2 id="1-1-打断设计："><a href="#1-1-打断设计：" class="headerlink" title="1.1 打断设计："></a>1.1 打断设计：</h2><p>在报运中它的数据库设计比较难，我在这设计时进行打断设计，实现跳跃查询。在设计时我们业务关联曾经是比较多的，报运和购销合同一对多关联，合同又跟货物一对多，货物又跟附件一对多。关联曾经过多，查询效率过多，这当数据大时（100万），查询效率就可能非常低，所以我对这的设计进行了优化，在主表中加入一个打断设计的字段，这个字段存储子表的多个主键。这样就无需建立外键关联。这样设计后，报运查询相关合同下的货物信息时，不像关联方式，必须由报运去找多个合同，再通过每个合同去找多个货物信息，而直接通过打断字段，利用sql in子查询从报运直接去查找合同下的货物信息。这样减少了关联曾经，查询效率很大提高。当系统的用户数据越来越多，业务关联层级越多，这种设计方式的效率越高。它跳跃了中间多层，实现跳跃查询。</p>
<h2 id="1-2-数据搬家（数据冗余）"><a href="#1-2-数据搬家（数据冗余）" class="headerlink" title="1.2 数据搬家（数据冗余）"></a>1.2 数据搬家（数据冗余）</h2><p>在报运时，本身货物信息需要新增7个字段，毛重、净重、长、宽、高、出口单价、含税，还需要合同下的货物的货号、数量、包装单位、件数等。如果按原始设计，读取报运信息后，一部分货物信息要从关联的报运下的货物信息中读取，还有一部分要从合同下的货物读取。这样设计比较麻烦，开发结构复杂，业务不利于开发人员学习业务。我们对其进行优化，我们为了查询更快，关系更简单，代码更简单，将相关的合同在报运新增时，直接把所需要的部分货物信息，货号、数量、包装单位、件数直接复制到报运下的货物表中，这样在报运修改时，直接补充7个字段。在需要报运信息时。就变得简单，直接读取报运下的货物表即可。同时，为了后续业务读取这部分货物信息，还有它们关联的附件信息，我们直接也将合同下的附件信息整体搬迁。这样后续的业务直接可以从报运相关的表中查询，而无需通过多级关联去合同下去找，关联曾经变少，效率提高很多。</p>
<h2 id="1-3-一对一的特殊设计"><a href="#1-3-一对一的特殊设计" class="headerlink" title="1.3 一对一的特殊设计"></a>1.3 一对一的特殊设计</h2><p>业务装箱和委托、发票、财务都是一对一的。我们为了设计上清晰，我们采用4张。主外键为一个值，委托、发票、财务直接就存放的是装箱单的ID。这样在程序中只要获得其中一个的ID，就可以查询其中任何一个对象。改变传统设计，传统设计财务关联发票，发票关联委托，委托关联装箱。财务需要获取报运的信息和装箱的信息，这时要财务要找到发票，发票找到委托，委托找到装箱，装箱找到多个报运。这样关联层级过多，速度比较慢。我们进行优化设计，改变对应关系，直接设计财务和装箱进行关联。上面的需求就非常简单，通过财务找到装箱，直接获取装箱的部分需要的信息，在通过装箱的打断设计字段，直接获取报运下的货物信息。实现多次跳跃查询。</p>
<h1 id="2-技术总结"><a href="#2-技术总结" class="headerlink" title="2.技术总结"></a>2.技术总结</h1><h2 id="2-2-页面结构，批量修改自定义控件"><a href="#2-2-页面结构，批量修改自定义控件" class="headerlink" title="2.2 页面结构，批量修改自定义控件"></a>2.2 页面结构，批量修改自定义控件</h2><p>在报运货物的修改中，批量进行数据修改，批量的业务就可以直接套用。利用动态表格技术，实现动态的往一个table中增加tr，动态往tr总增加td，它文本框，单选框，多选框，下拉框，大文本。利用一个js函数addRecord反复调用，就可以实现往表格中插入数据。数据在后台service层进行js串拼接，在拼接过程中，将业务数据就拼接进去。然后利用jQuery ready事件进行js动态执行。由于js运行非常快，用户感知不到表格数据的动态增加，他以为直接展现。如果数据在600行。这时不能使用通过ready事件一行一行执行。如果超过600行，采用<c:foreach>的方式来实现。在批量修改时，我就增加了一个行标识，来标识本行记录是否修改，如果修改了，在后台就进行更新，如果没有修改，就不更新操作。</c:foreach></p>
<h2 id="2-3POI复杂报表打印"><a href="#2-3POI复杂报表打印" class="headerlink" title="2.3POI复杂报表打印"></a>2.3POI复杂报表打印</h2><p>购销合同复杂报表的打印，这个报表中需要插入用户LOGO，可以插入多个货物的图片，可以插入一根分割线，对合计的值进行公式的设置，打印时用户可以自定义设置打印一款货物，还是打印两款货物，货物生产厂家如果不同，还必须另起一页。获取一个合同信息和多个货物信息。</p>
<h2 id="2-3-POI百万数据导出"><a href="#2-3-POI百万数据导出" class="headerlink" title="2.3 POI百万数据导出"></a>2.3 POI百万数据导出</h2><p>在POI高版本中提供了一个特殊的构造方法SXSSF对象，利用这个对象，在构造时可以设定一个参数，产生对象的数量，根据这个数量，在大数据量导出时，当创建这么多对象后，直接POI写到xml临时文件中。当真正写文件时，再从临时文件中获取信息，输出内容。这样做解决了早期版本中，直接在内存中创建大量对象，导致非常容易内存堆溢出。它不支持模板文件操作。</p>
<h2 id="2-4-amcharts-分析统计"><a href="#2-4-amcharts-分析统计" class="headerlink" title="2.4 amcharts 分析统计"></a>2.4 amcharts 分析统计</h2><ol>
<li>组织数据</li>
<li>拼接字符串，拼接为amchart官网Demo的html格式</li>
</ol>
<h1 id="3-革命尚未成功，还需继续努力"><a href="#3-革命尚未成功，还需继续努力" class="headerlink" title="3.革命尚未成功，还需继续努力"></a>3.革命尚未成功，还需继续努力</h1><ol>
<li>工作流采用最新的Activiti5 5.16版本，它会自动创建24张表，多了一张日志表。在购销合同上报时，同时启动流程。销售专责就行购销合同的处理，然后提交流程到销售部领导的审批，销售部领导审批通过后，提交到船运部。船运部报运专责开始处理报运业务，处理完成，提交给船运部报运经理进行审核，报运经理审核通过后，他提交给船运部装箱专责。船运部装箱专责处理装箱业务，处理完成提交给装箱经理审批，装箱经理审批后，提交给委托专责，委托专责处理委托业务，处理完成提交给发票经理审批，发票经理审批通过后提交给财务部，财务部财务专责处理内部核算，提交给财务经理审批。财务经理审批通过后，流程完成。</li>
<li>并发处理<br>购销合同打印，首先打印时，将临时文件放在服务器的临时目录。基于windows处理文件并发机制。当打印时产生一个文件名，先判断临时目录中文件是否存在，如果存在自动给其再编一个新的名称，再次判断如果这个名称还冲突，再重新命名，只到没有冲突为止。<br>下载，下载时控制下载的人数，当这个数量超过阀值（10个，通过配置文件配置），action进行转向友好提示页面，“用户当前下载人数过多，请稍后下载”。</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/16/jk9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FangChao.Qu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiangImg.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FangChao.Qu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/16/jk9/" itemprop="url">
                  基于SSM的商贸平台项目（第九天）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-16T09:26:46+08:00">
                2017-06-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-让微软汗颜的图形报表"><a href="#1-让微软汗颜的图形报表" class="headerlink" title="1.让微软汗颜的图形报表"></a>1.让微软汗颜的图形报表</h1><p>思路：</p>
<ol>
<li>组织数据源</li>
<li>拼接字符串，拼接为amchart官网Demo的html格式<h2 id="1-1饼形图："><a href="#1-1饼形图：" class="headerlink" title="1.1饼形图："></a>1.1饼形图：</h2><img src="/images/91.png" alt="Alt text"></li>
</ol>
<h2 id="1-2柱状图"><a href="#1-2柱状图" class="headerlink" title="1.2柱状图"></a>1.2柱状图</h2><p><img src="/images/92.png" alt="Alt text"></p>
<h2 id="1-3折线图"><a href="#1-3折线图" class="headerlink" title="1.3折线图"></a>1.3折线图</h2><p><img src="/images/93.png" alt="Alt text"></p>
<h1 id="2-异构数据库-让程序支持主流数据库切换"><a href="#2-异构数据库-让程序支持主流数据库切换" class="headerlink" title="2.异构数据库,让程序支持主流数据库切换"></a>2.异构数据库,让程序支持主流数据库切换</h1><p><img src="/images/94.png" alt="Alt text"></p>
<p>程序开发时有要求：</p>
<ol>
<li>不能使用存储过程，不能使用规则rule，不能使用触发器；</li>
<li>可以少量使用view。基于程序方便维护，程序通用性强，减少对数据库的依赖，增强程序代码的处理。也就是现今大多数软件公司都减少dba的角色，增强java代码来处理。<br>特例：但在大型项目中，分页采用存储过程。</li>
</ol>
<ol>
<li><p>在企业的实际开发中，由于这种底层封装效率太低，要做大量数据操作时或者大量连接查询统计时，spring jdbctemplate 直接访问数据。sqlDao封装spring jdbctemplate。</p>
</li>
<li><p>sqlDao返回list集合实际是一个一唯字符串数组</p>
<h1 id="3-分表技术"><a href="#3-分表技术" class="headerlink" title="3.分表技术"></a>3.分表技术</h1></li>
</ol>
<p>当业务数据量非常巨大时，常用的优化方式。一张表的数据量过大，这样在日常的操作时速度非常缓慢。怎么提高它的响应的速度，实际中就是将一些不常在使用的数据移动到另一张表中，而这另一张表叫历史表。历史表和原来的表结构一致。这样当前表由于只使用当前的部分数据，所以性能提高。因为实际业务中很少再去查询历史表，即使查询历史表由于使用的人也少，所以它的性能还能适应。</p>
<p>表结构一样，新创建表结果跟它一样</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/15/win10/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FangChao.Qu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiangImg.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FangChao.Qu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/15/win10/" itemprop="url">
                  在HDD+SSD的zotac 1060，装win10于SSD
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-15T09:26:46+08:00">
                2017-06-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-自制win10系统U盘"><a href="#1-自制win10系统U盘" class="headerlink" title="1.自制win10系统U盘"></a>1.自制win10系统U盘</h1><p><a href="http://jingyan.baidu.com/article/a378c960630e61b329283045.html" target="_blank" rel="external">UltralSO 系统U盘制作链接</a></p>
<h1 id="2-装系统ing……"><a href="#2-装系统ing……" class="headerlink" title="2.装系统ing……"></a>2.装系统ing……</h1><h3 id="2-1-开机时，按Esc进入主板Biso设置界面"><a href="#2-1-开机时，按Esc进入主板Biso设置界面" class="headerlink" title="2.1    开机时，按Esc进入主板Biso设置界面"></a>2.1    开机时，按Esc进入主板Biso设置界面</h3><h3 id="2-2-按F8进入U盘启动（因自己的PC主板而异）"><a href="#2-2-按F8进入U盘启动（因自己的PC主板而异）" class="headerlink" title="2.2    按F8进入U盘启动（因自己的PC主板而异）"></a>2.2    按F8进入U盘启动（因自己的PC主板而异）</h3><h3 id="2-3-插入U盘，重新启动，进入U盘启动，按照提示一步一步，进入分区设置，系统装入分区设置，因自己需求设置相应的的分区"><a href="#2-3-插入U盘，重新启动，进入U盘启动，按照提示一步一步，进入分区设置，系统装入分区设置，因自己需求设置相应的的分区" class="headerlink" title="2.3    插入U盘，重新启动，进入U盘启动，按照提示一步一步，进入分区设置，系统装入分区设置，因自己需求设置相应的的分区"></a>2.3    插入U盘，重新启动，进入U盘启动，按照提示一步一步，进入分区设置，系统装入分区设置，因自己需求设置相应的的分区</h3><h3 id="2-4-在设置分区界面，shift-f10进入dos操作命令界面"><a href="#2-4-在设置分区界面，shift-f10进入dos操作命令界面" class="headerlink" title="2.4    在设置分区界面，shift+f10进入dos操作命令界面"></a>2.4    在设置分区界面，shift+f10进入dos操作命令界面</h3><h4 id="2-4-1-第一步、全新安装系统过程中，在选择目标磁盘，安装程序会提示不创建GPT分区，不能完成安装，这时候我们按下Shift-F10，会出现命令提示符-管理员-界面"><a href="#2-4-1-第一步、全新安装系统过程中，在选择目标磁盘，安装程序会提示不创建GPT分区，不能完成安装，这时候我们按下Shift-F10，会出现命令提示符-管理员-界面" class="headerlink" title="2.4.1 第一步、全新安装系统过程中，在选择目标磁盘，安装程序会提示不创建GPT分区，不能完成安装，这时候我们按下Shift+F10，会出现命令提示符(管理员)界面"></a>2.4.1 第一步、全新安装系统过程中，在选择目标磁盘，安装程序会提示不创建GPT分区，不能完成安装，这时候我们按下Shift+F10，会出现命令提示符(管理员)界面</h4><h4 id="2-4-2-第二步、键入diskpart命令后回车，然后完成下面的命令，相关命令为："><a href="#2-4-2-第二步、键入diskpart命令后回车，然后完成下面的命令，相关命令为：" class="headerlink" title="2.4.2 第二步、键入diskpart命令后回车，然后完成下面的命令，相关命令为："></a>2.4.2 第二步、键入diskpart命令后回车，然后完成下面的命令，相关命令为：</h4><pre><code>1、list disk-------------------列出系统计算机所有磁盘
2、select disk 0 --------------选择0号磁盘，数字并不一定和下面截图完全相同
我们需要根据磁盘大小，判断安装系统的目标磁盘
</code></pre><h4 id="2-4-3-第三步、选定磁盘后，完成下述命令，相关命令为："><a href="#2-4-3-第三步、选定磁盘后，完成下述命令，相关命令为：" class="headerlink" title="2.4.3 第三步、选定磁盘后，完成下述命令，相关命令为："></a>2.4.3 第三步、选定磁盘后，完成下述命令，相关命令为：</h4><pre><code>1、clean------------------------清除磁盘,该命令将擦除磁盘上的所有数据
2、convert gpt------------------将磁盘转换为GPT格式
3、list partition---------------列出磁盘上的分区

完成查处和转换操作后，输入list partition命令，会显示这个磁盘上没有显示的分区，是因为我们刚4刚完成转换成GPT分区格式，分区为空
</code></pre><h4 id="2-4-4-第四步、接下来要创建EFI分区及系统安装分区，相关命令为："><a href="#2-4-4-第四步、接下来要创建EFI分区及系统安装分区，相关命令为：" class="headerlink" title="2.4.4 第四步、接下来要创建EFI分区及系统安装分区，相关命令为："></a>2.4.4 第四步、接下来要创建EFI分区及系统安装分区，相关命令为：</h4><p>　　1. create partition efi size=100–创建EFI分区，大小为100M<br>　　2. create partition msr size=128–创建MSR分区，微软默认大小是128M<br>　　3. create partition primary size=50000–创建主分区，这里要注意数字按M计算，50000就是分区大小为50000M，可以根据自己实际情况调整，该分区用来安装win7<br>　　4. list partition—————–列出磁盘上的分区</p>
<pre><code>温馨提示：diskpart命令的详细内容，可以利用键入help命令查看
</code></pre><h4 id="2-4-5-第五步、输入Exit，退出命令提示符界面，返回安装界面"><a href="#2-4-5-第五步、输入Exit，退出命令提示符界面，返回安装界面" class="headerlink" title="2.4.5　　第五步、输入Exit，退出命令提示符界面，返回安装界面"></a>2.4.5　　第五步、输入Exit，退出命令提示符界面，返回安装界面</h4><p>　　利用diskpart命令创建GPT磁盘分区图文教程的内容，看着很复杂，实际上比起第三方磁盘工具，优势表现在可以更改GPT格式磁盘的分区ID</p>
<p>  [具体操作链接](<a href="http://www.beihaiting.com/a/XTJC/XTJQ/2014/0815/5127.html）" target="_blank" rel="external">http://www.beihaiting.com/a/XTJC/XTJQ/2014/0815/5127.html）</a></p>
<h1 id="3-ssd装系统注意事项"><a href="#3-ssd装系统注意事项" class="headerlink" title="3.ssd装系统注意事项"></a>3.ssd装系统注意事项</h1><ol>
<li>4k分区（网上说的，但是自己没用到,因为是重新格式化的ssd，所以默认是4k分区）</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/07/jk8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FangChao.Qu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiangImg.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FangChao.Qu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/07/jk8/" itemprop="url">
                  基于SSM的商贸平台项目（第八天）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-07T09:26:46+08:00">
                2017-06-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-设计方式"><a href="#1-设计方式" class="headerlink" title="1.设计方式"></a>1.设计方式</h1><h2 id="1-1打断设计："><a href="#1-1打断设计：" class="headerlink" title="1.1打断设计："></a>1.1打断设计：</h2><p>传统方式创建对象关联，当业务层级过多，查询效率极速下降，业界有个不成文的规定，在数据库表设计时，关联关系部超过4层。打断设计将业务多级进行分解，硬拆成多个块。具体实现就是通过一个字段来存储两个表之间的关系。存储主表的ID，将多个ID用特殊符号分割。</p>
<p>##1.2数据搬家：（冗余，分次计算）<br>将合同下的部分信息直接放在报运下的货物表中，这样直接在报运的货物表中查询（无需关心是哪个合同的货物信息，也无需关系货物部分信息和报运部分信息的对应）</p>
<p>由于有分次报运的概念，因为一个货物可以分多次报运，一个合同下的货物信息，可能分多次报运，最终所有货物报运完成。例如：1000，第一次报运800，第二次报运200。不能将报运新增的7个字段，冗余到合同下的货物表中。</p>
<p>报运的附件表实现了整体的数据搬家，为了后续业务在查询货物时，也可以直接查询到附件信息，主要是为财务业务服务。</p>
<p>##1.3分次计算<br>当系统中有一个集中处理数据的地方，如果它非常耗时，我们对其要进行优化。例如：毛重、净重、体积信息。它会导致用户等待。我们对其进行优化，将集中计算分到不同的地方。我们将总的计算，分解到货物新增时，只计算一条。用户由于本身新增数据，他感觉要保存新增的数据，所以他能容忍稍微等待。在新增时程序动态计算冗余的内容。因为处理数据量极其小，造成处理速度很快，几乎用户感觉不到延迟。</p>
<h1 id="2-特殊设计：一对一；"><a href="#2-特殊设计：一对一；" class="headerlink" title="2.特殊设计：一对一；"></a>2.特殊设计：一对一；</h1><p>1）    委托ID就是装箱ID，发票ID就是装箱ID，财务ID就是装箱ID。<br>2）    委托、发票、财务它们的主键既外键<br>无论获得一个什么ID，只要是装箱、委托、发票、财务其中之一，就可以获得任何一个它们的对象。</p>
<p>#2.传递数据时，数据可以隐藏到同一个框中<br>实际开发中少量传递数据的方式。无需查询数据库，提高性能，缺点就需要手动拼串，解串。</p>
<pre><code>// 拼接HTML片段
public String getDivDataCreate(String[] contractIds) {
    StringBuffer sBuf = new StringBuffer();
    for (int i = 0; i &lt; contractIds.length; i++) {
        Export export = exportDao.get(contractIds[i]);
        sBuf.append(
                &quot;&lt;input type=\&quot;checkbox\&quot; name=\&quot;exportIds\&quot; checked value=\&quot;&quot;)
                .append(contractIds[i]).append(&quot;|&quot;)
                .append(export.getCustomerContract())
                .append(&quot;\&quot; class=\&quot;input\&quot;/&gt;&quot;);
        sBuf.append(export.getCustomerContract()).append(&quot;&amp;nbsp;&amp;nbsp;&quot;);
    }
    return sBuf.toString();
}

// 拆串拼串
private PackingList spellString(PackingList packingList) {
    String _exportIds = &quot;&quot;;
    String _exportNos = &quot;&quot;;

    String[] _ids = packingList.getExportIds().split(&quot;,&quot;);
    for (int i = 0; i &lt; _ids.length; i++) {
        String[] _temids = _ids[i].split(&quot;\\|&quot;); // 正则表达式，转义
        _exportIds += _temids[0] + &quot;|&quot;;
        _exportNos += _temids[1] + &quot;|&quot;;
    }
    _exportIds = UtilFuns.delLastChar(_exportIds); // 去掉最后的“|”
    _exportNos = UtilFuns.delLastChar(_exportNos);

    packingList.setExportIds(_exportIds);
    packingList.setExportNos(_exportNos);
    return packingList;
}
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/02/jk7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FangChao.Qu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiangImg.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FangChao.Qu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/02/jk7/" itemprop="url">
                  基于SSM的商贸平台项目（第七天）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-02T09:26:46+08:00">
                2017-06-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-新的设计方式：打断设计"><a href="#1-新的设计方式：打断设计" class="headerlink" title="1.新的设计方式：打断设计"></a>1.新的设计方式：打断设计</h1><p>在表中增加一个字段，这个字段用来存储关联表的主键集合；在报运业务中要查询合同下的货物信息。直接通过这个关联字段，利用in子查询直接去查询货物表，这样查询效率提高很多。而且数据量越大，查询效率越高。这种方式，业务关联层级越多，这种设计方式的性能体现越高。而且通过这种方式可以实现跳跃查询。</p>
<h1 id="2-在jsp页面动态增加表格"><a href="#2-在jsp页面动态增加表格" class="headerlink" title="2.在jsp页面动态增加表格"></a>2.在jsp页面动态增加表格</h1><p>##2.1动态表格：<br>innerHTML 实现往一个区域div增加一段html代码，</p>
<p>table,tr,td都用利用js动态插入</p>
<p> <img src="/images/71.png" alt="Alt text"></p>
<pre><code>/*实现动态增加一行*/
function addTRRecord(objId, id, productNo, cnumber, grossWeight, netWeight, sizeLength, sizeWidth, sizeHeight, exPrice, tax) {

    var _tmpSelect = &quot;&quot;;
    var tableObj = document.getElementById(objId);        //得到表格对象
    var rowLength = tableObj.rows.length;                //获取行的长度

    oTR = tableObj.insertRow();                            //新增一行

    oTD = oTR.insertCell(0);                            //新增单元格，下标从0开始
    oTD.style.whiteSpace=&quot;nowrap&quot;;
    oTD.ondragover = function(){this.className=&quot;drag_over&quot; };    //动态加事件, 改变样式类
    oTD.ondragleave = function(){this.className=&quot;drag_leave&quot; };
    oTD.onmousedown = function(){ clearTRstyle(&quot;result&quot;); this.parentNode.style.background = &apos;#0099cc&apos;;};    
    //this.style.background=&quot;#0099cc url(../images/arroww.gif) 4px 9px no-repeat&quot;;
    oTD.innerHTML = &quot;&amp;nbsp;&amp;nbsp;&quot;;    
    oTD = oTR.insertCell(1);
    oTD.innerHTML = &quot;&lt;input class=\&quot;input\&quot; type=\&quot;checkbox\&quot; name=\&quot;del\&quot; value=\&quot;&quot;+id+&quot;\&quot;&gt;&lt;input type=\&quot;hidden\&quot; name=\&quot;mr_id\&quot; value=\&quot;&quot;+id+&quot;\&quot;&gt;&lt;input class=\&quot;input\&quot; type=\&quot;hidden\&quot; id=\&quot;mr_changed\&quot; name=\&quot;mr_changed\&quot;&gt;&quot;;
    oTD = oTR.insertCell(2);
    oTD.innerHTML = &quot;&lt;input class=\&quot;input\&quot; type=\&quot;text\&quot; name=\&quot;mr_orderNo\&quot; readonly size=\&quot;3\&quot; value=\&quot;\&quot;&gt;&quot;;
    oTD = oTR.insertCell(3);
    oTD.innerHTML = &quot;&lt;b&gt;&lt;font face=&apos;微软雅黑&apos;&gt;&lt;font color=&apos;blue&apos;&gt;&quot;+productNo;+&quot;&lt;/font&gt;&lt;/font&gt;&lt;/b&gt; &quot;
    oTD = oTR.insertCell(4);
    oTD.innerHTML = &quot;&lt;input type=\&quot;text\&quot; name=\&quot;mr_cnumber\&quot; maxLength=\&quot;10\&quot; value=\&quot;&quot;+cnumber+&quot;\&quot; onBlur=\&quot;setTRUpdateFlag(this);\&quot; size=\&quot;15\&quot;&gt;&quot;;
    oTD = oTR.insertCell(5);
    oTD.innerHTML = &quot;&lt;input type=\&quot;text\&quot; name=\&quot;mr_grossWeight\&quot; maxLength=\&quot;10\&quot; value=\&quot;&quot;+grossWeight+&quot;\&quot; onBlur=\&quot;setTRUpdateFlag(this);\&quot; size=\&quot;15\&quot;&gt;&quot;;
    oTD = oTR.insertCell(6);
    oTD.innerHTML = &quot;&lt;input type=\&quot;text\&quot; name=\&quot;mr_netWeight\&quot; maxLength=\&quot;10\&quot; value=\&quot;&quot;+netWeight+&quot;\&quot; onBlur=\&quot;setTRUpdateFlag(this);\&quot; size=\&quot;15\&quot;&gt;&quot;;
    oTD = oTR.insertCell(7);
    oTD.innerHTML = &quot;&lt;input type=\&quot;text\&quot; name=\&quot;mr_sizeLength\&quot; maxLength=\&quot;10\&quot; value=\&quot;&quot;+sizeLength+&quot;\&quot; onBlur=\&quot;setTRUpdateFlag(this);\&quot; size=\&quot;15\&quot;&gt;&quot;;
    oTD = oTR.insertCell(8);
    oTD.innerHTML = &quot;&lt;input type=\&quot;text\&quot; name=\&quot;mr_sizeWidth\&quot; maxLength=\&quot;10\&quot; value=\&quot;&quot;+sizeWidth+&quot;\&quot; onBlur=\&quot;setTRUpdateFlag(this);\&quot; size=\&quot;15\&quot;&gt;&quot;;
    oTD = oTR.insertCell(9);
    oTD.innerHTML = &quot;&lt;input type=\&quot;text\&quot; name=\&quot;mr_sizeHeight\&quot; maxLength=\&quot;10\&quot; value=\&quot;&quot;+sizeHeight+&quot;\&quot; onBlur=\&quot;setTRUpdateFlag(this);\&quot; size=\&quot;15\&quot;&gt;&quot;;
    oTD = oTR.insertCell(10);
    oTD.innerHTML = &quot;&lt;input type=\&quot;text\&quot; name=\&quot;mr_exPrice\&quot; maxLength=\&quot;10\&quot; value=\&quot;&quot;+exPrice+&quot;\&quot; onBlur=\&quot;setTRUpdateFlag(this);\&quot; size=\&quot;15\&quot;&gt;&quot;;
    oTD = oTR.insertCell(11);
    oTD.innerHTML = &quot;&lt;input type=\&quot;text\&quot; name=\&quot;mr_tax\&quot; maxLength=\&quot;10\&quot; value=\&quot;&quot;+tax+&quot;\&quot; onBlur=\&quot;setTRUpdateFlag(this);\&quot; size=\&quot;15\&quot;&gt;&quot;;

    dragtableinit();    //拖动表格行
    sortnoTR();            //排序号

}    
</code></pre><p>##2.2修改新增的字段</p>
<ol>
<li>页面上使用同名框，reqest.getParameterValues()，形成一个Sring数组</li>
<li>Struts2框架封装为可以根据它的类型数组，改造ModelDriver<br>字符类型，将多个值拼接成一个字符串，之间用逗号+空格隔开<br>整形、浮点型、日期等，只保留第一个</li>
<li>Springmvc框架封装为数组，在方法调用参数上声明<br>字符类型，将多个值拼接成一个字符串，之间用逗号隔开<br>整形、浮点型、日期等，只保留第一个</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/27/jk6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FangChao.Qu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiangImg.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FangChao.Qu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/27/jk6/" itemprop="url">
                  基于SSM的商贸平台项目（第六天）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-27T09:26:46+08:00">
                2017-05-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="报表引擎，复杂的报表打印"><a href="#报表引擎，复杂的报表打印" class="headerlink" title="报表引擎，复杂的报表打印"></a>报表引擎，复杂的报表打印</h1><p> <img src="/images/6style.png" alt="Alt text"></p>
<h2 id="1-技术难点"><a href="#1-技术难点" class="headerlink" title="1.技术难点"></a>1.技术难点</h2><ol>
<li><p>插入图片，POI插入图片时，设定区域，自动缩放到这个区域中，图片要设置偏移量<br> HSSFPatriarch patriarch = sheet.createDrawingPatriarch();        //add picture<br> poiUtil.setPicture(wb, patriarch, path+”make/xlsprint/logo.jpg”, curRow, 2, curRow+4, 2);</p>
</li>
<li><p>模板，对于购销合同它不能直接做模板。代码中不能做这个功能。Excel支持区域复制。但是目前POI不直接支持区域复制。（合并单元格在sheet对象中、图片、线等）（基于用户使用系统，以及POI不直接支持区域复制，所以它不能直接使用模板）<br>A.    只是改变列宽<br>B.    画一个sheet，利用poi支持sheet的复制，保留样式。</p>
</li>
<li><p>插入一根线，设置两个坐标，它直接连线，可以是直线，可以是斜线，可以设置偏移量<br>poiUtil.setLine(wb, patriarch, curRow, 2, curRow, 8);    //draw line</p>
</li>
<li><p>合并单元格，特点：合并单元格的边线样式，它实际上是在合并前的单元格上设置的。特殊的地方：在单元格如果有样式，合并单元格的这几个格子都必须设置边线样式。<br>CellRangeAddress region = null;<br>region = new CellRangeAddress(curRow-1, curRow-1, 1, 3);    //纵向合并单元格<br>//不需要设置内容，只设置样式，补齐线。</p>
<pre><code>for(int j=2;j&lt;9;j++){
    nCell = nRow.createCell(j);
    nCell.setCellStyle(poiUtil.notehv10_BorderThin(wb, defaultFont10));
}
</code></pre></li>
<li><p>换行<br>curStyle.setWrapText(true);</p>
</li>
<li>设置人民币符号（前缀）<br>format.getFormat(“\”￥\”#,###,###.00”);</li>
<li>设置公式，乘法，合计公式<br>nCell.setCellType(HSSFCell.CELL_TYPE_FORMULA);<br>nCell.setCellFormula(“F”+String.valueOf(curRow)+”*H”+String.valueOf(curRow));</li>
<li>实现审单人的人名等量空格替换，实现它后面的位置不变（工具类）<br>utilFuns.fixSpaceStr(contract.getCheckBy(),26)</li>
<li>单元格自适应（工具类）<br>float height = poiUtil.getCellAutoHeight(printMap.get(“Request”), 12f);        //自动高度</li>
<li><p>数据和业务分离,一页数据封装到一个map中，以业务字段名称定义KEY，以string定义内容,所有页面封装到一个arraylist。<br> Map<string,string> pageMap = null;<br> List<map> pageList = new ArrayList();            //打印页</map></string,string></p>
</li>
<li><p>插入分页符</p>
<pre><code>if(p&gt;0){
    sheet.setRowBreak(curRow++);    //在第startRow行设置分页符
}
</code></pre></li>
<li>公用的工具类PoiUtil poiUtil = new PoiUtil();  样式，特殊内容封装</li>
<li>return format.getFormat(“\”￥\”#,###,##0.00”); // 设置格式<br>0代表，这位值如果不为零，显示原来的内容，直接输出0<br>,#代表，这位值如果存在，就直接显示，不存在，就不显示。</li>
<li>nCell.setCellType(HSSFCell.CELL_TYPE_NUMERIC);<h2 id="2-代码整理"><a href="#2-代码整理" class="headerlink" title="2.代码整理"></a>2.代码整理</h2></li>
</ol>
<pre><code>import java.io.ByteArrayOutputStream;
import java.io.FileInputStream;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.servlet.http.HttpServletResponse;

import org.apache.poi.hssf.usermodel.HSSFCell;
import org.apache.poi.hssf.usermodel.HSSFCellStyle;
import org.apache.poi.hssf.usermodel.HSSFFont;
import org.apache.poi.hssf.usermodel.HSSFPatriarch;
import org.apache.poi.hssf.usermodel.HSSFRow;
import org.apache.poi.hssf.usermodel.HSSFSheet;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.hssf.util.CellRangeAddress;

import cn.itcast.jk.vo.ContractProductVO;
import cn.itcast.jk.vo.ContractVO;
import cn.itcast.util.DownloadUtil;
import cn.itcast.util.UtilFuns;
import cn.itcast.util.file.PoiUtil;

public class ContractPrint{

public void print(ContractVO contract,String path, HttpServletResponse response) throws Exception{
    //相同厂家的信息一起打印
    List&lt;ContractProductVO&gt; oList = contract.getContractProducts();
    UtilFuns utilFuns = new UtilFuns();
    String tempXlsFile = path + &quot;make/xlsprint/tCONTRACT.xls&quot;;        //获取模板文件

    //填写每页的内容，之后在循环每页读取打印
    Map&lt;String,String&gt; pageMap = null;
    List&lt;Map&gt; pageList = new ArrayList();            //打印页

    ContractProductVO oProduct = null;
    String stars = &quot;&quot;;
    for(int j=0;j&lt;contract.getImportNum();j++){        //重要程度
        stars += &quot;★&quot;;
    }

    String oldFactory = &quot;&quot;;
    for(int i=0;i&lt;oList.size();i++){
        oProduct = oList.get(i);    //获得货物
        pageMap = new HashMap();    //每页的内容

        pageMap.put(&quot;Offeror&quot;, &quot;收 购 方：&quot; + contract.getOfferor());
        pageMap.put(&quot;Factory&quot;, &quot;生产工厂：&quot; + oProduct.getFactory().getFactoryName());
        pageMap.put(&quot;ContractNo&quot;, &quot;合 同 号：&quot; + contract.getContractNo());
        pageMap.put(&quot;Contractor&quot;, &quot;联 系 人：&quot; + oProduct.getFactory().getContacts());
        pageMap.put(&quot;SigningDate&quot;, &quot;签单日期：&quot;+UtilFuns.formatDateTimeCN(UtilFuns.dateTimeFormat(contract.getSigningDate())));
        pageMap.put(&quot;Phone&quot;, &quot;电    话：&quot; + oProduct.getFactory().getPhone());
        pageMap.put(&quot;InputBy&quot;, &quot;制单：&quot; + contract.getInputBy());
        pageMap.put(&quot;CheckBy&quot;, &quot;审单：&quot;+ utilFuns.fixSpaceStr(contract.getCheckBy(),26)+&quot;验货员：&quot;+utilFuns.convertNull(contract.getInspector()));
        pageMap.put(&quot;Remark&quot;, &quot;  &quot;+contract.getRemark());
        pageMap.put(&quot;Request&quot;, &quot;  &quot;+contract.getCrequest());

        pageMap.put(&quot;ProductImage&quot;, oProduct.getProductImage());
        pageMap.put(&quot;ProductDesc&quot;, oProduct.getProductDesc());
        pageMap.put(&quot;Cnumber&quot;, String.valueOf(oProduct.getCnumber().doubleValue()));
        if(oProduct.getPackingUnit().equals(&quot;PCS&quot;)){
            pageMap.put(&quot;PackingUnit&quot;, &quot;只&quot;);
        }else if(oProduct.getPackingUnit().equals(&quot;SETS&quot;)){
            pageMap.put(&quot;PackingUnit&quot;, &quot;套&quot;);
        }
        pageMap.put(&quot;Price&quot;, String.valueOf(oProduct.getPrice().doubleValue()));
        pageMap.put(&quot;ProductNo&quot;, oProduct.getProductNo());

        oldFactory = oProduct.getFactory().getFactoryName();

        if(contract.getPrintStyle().equals(&quot;2&quot;)){
            i++;    //读取第二个货物信息
            if(i&lt;oList.size()){
                oProduct = oList.get(i);

                if(oProduct.getFactory().getFactoryName().equals(oldFactory)){    //厂家不同另起新页打印，除去第一次的比较

                    pageMap.put(&quot;ProductImage2&quot;, oProduct.getProductImage());
                    pageMap.put(&quot;ProductDesc2&quot;, oProduct.getProductDesc());
                    pageMap.put(&quot;Cnumber2&quot;, String.valueOf(oProduct.getCnumber().doubleValue()));
                    if(oProduct.getPackingUnit().equals(&quot;PCS&quot;)){
                        pageMap.put(&quot;PackingUnit2&quot;, &quot;只&quot;);
                    }else if(oProduct.getPackingUnit().equals(&quot;SETS&quot;)){
                        pageMap.put(&quot;PackingUnit2&quot;, &quot;套&quot;);
                    }                        
                    pageMap.put(&quot;Price2&quot;, String.valueOf(oProduct.getPrice().doubleValue()));
                    //pageMap.put(&quot;Amount2&quot;, String.valueOf(oProduct.getAmount().doubleValue()));            //在excel中金额采用公式，所以无需准备数据
                    pageMap.put(&quot;ProductNo2&quot;, oProduct.getProductNo());
                }else{
                    i--;    //tip:list退回
                }
            }else{
                pageMap.put(&quot;ProductNo2&quot;, null);    //后面依据此判断是否有第二个货物
            }
        }

        pageMap.put(&quot;ContractDesc&quot;, stars+&quot; 货物描述&quot;);            //重要程度 + 货物描述

        pageList.add(pageMap);
    }

        int cellHeight = 96;    //一个货物的高度            用户需求，一个货物按192高度打印，后来又嫌难看，打印高度和2款高度一样。
//        if(contract.getPrintStyle().equals(&quot;2&quot;)){
//            cellHeight = 96;    //两个货物的高度
//        }

    PoiUtil poiUtil = new PoiUtil();
    HSSFWorkbook wb = new HSSFWorkbook(new FileInputStream(tempXlsFile));    //打开excel文件
    HSSFFont defaultFont10 = poiUtil.defaultFont10(wb);        //设置字体
    HSSFFont defaultFont12 = poiUtil.defaultFont12(wb);        //设置字体
    HSSFFont blackFont = poiUtil.blackFont12(wb);            //设置字体
    Short rmb2Format = poiUtil.rmb2Format(wb);                //设置格式
    Short rmb4Format = poiUtil.rmb4Format(wb);                //设置格式


    HSSFSheet sheet = wb.getSheetAt(0);                //选择第一个工作簿
    wb.setSheetName(0, &quot;购销合同&quot;);                    //设置工作簿的名称


    //sheet.setDefaultColumnWidth((short) 20);         // 设置每列默认宽度

//        POI分页符有BUG，必须在模板文件中插入一个分页符，然后再此处删除预设的分页符；最后在下面重新设置分页符。
//        sheet.setAutobreaks(false);
//        int iRowBreaks[] = sheet.getRowBreaks();
//        sheet.removeRowBreak(3);
//        sheet.removeRowBreak(4);
//        sheet.removeRowBreak(5);
//        sheet.removeRowBreak(6);

    CellRangeAddress region = null;
    HSSFPatriarch patriarch = sheet.createDrawingPatriarch();        //add picture

    HSSFRow nRow = null;
    HSSFCell nCell   = null;
    int curRow = 0;

    //打印每页
    Map&lt;String,String&gt; printMap = null;
    for(int p=0;p&lt;pageList.size();p++){
        printMap = pageList.get(p);

        if(p&gt;0){
            sheet.setRowBreak(curRow++);    //在第startRow行设置分页符
        }


        //设置logo图片
        poiUtil.setPicture(wb, patriarch, path+&quot;make/xlsprint/logo.jpg&quot;, curRow, 2, curRow+4, 2);

        //header
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(21);

        nCell   = nRow.createCell((3));
        nCell.setCellValue(&quot;SHAANXI&quot;);
        nCell.setCellStyle(headStyle(wb));

        //header
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(41);

        nCell   = nRow.createCell((3));
        nCell.setCellValue(&quot;     JK INTERNATIONAL &quot;);
        nCell.setCellStyle(tipStyle(wb));

        curRow++;

        //header
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(20);

        nCell   = nRow.createCell((1));
        nCell.setCellValue(&quot;                 西经济技术开发区西城一路27号无迪大厦19楼&quot;);
        nCell.setCellStyle(addressStyle(wb));

        //header
        nCell   = nRow.createCell((6));
        nCell.setCellValue(&quot; CO., LTD.&quot;);
        nCell.setCellStyle(ltdStyle(wb));

        //header
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(15);

        nCell   = nRow.createCell((1));
        nCell.setCellValue(&quot;                   TEL: 0086-29-86339371  FAX: 0086-29-86303310               E-MAIL: ijackix@glass.cn&quot;);
        nCell.setCellStyle(telStyle(wb));

        //line
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(7);

        poiUtil.setLine(wb, patriarch, curRow, 2, curRow, 8);    //draw line

        //header
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(30);

        nCell   = nRow.createCell((4));
        nCell.setCellValue(&quot;    购   销   合   同&quot;);
        nCell.setCellStyle(titleStyle(wb));

        //Offeror
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(20);

        nCell   = nRow.createCell((1));
        nCell.setCellValue(printMap.get(&quot;Offeror&quot;));
        nCell.setCellStyle(poiUtil.titlev12(wb, blackFont));

        //Facotry
        nCell   = nRow.createCell((5));
        nCell.setCellValue(printMap.get(&quot;Factory&quot;));
        nCell.setCellStyle(poiUtil.titlev12(wb, blackFont));

        //ContractNo
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(20);

        nCell   = nRow.createCell(1);
        nCell.setCellValue(printMap.get(&quot;ContractNo&quot;));
        nCell.setCellStyle(poiUtil.titlev12(wb, blackFont));

        //Contractor
        nCell  = nRow.createCell(5);
        nCell.setCellValue(printMap.get(&quot;Contractor&quot;));
        nCell.setCellStyle(poiUtil.titlev12(wb, blackFont));

        //SigningDate
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(20);

        nCell = nRow.createCell(1);
        nCell.setCellValue(printMap.get(&quot;SigningDate&quot;));
        nCell.setCellStyle(poiUtil.titlev12(wb, blackFont));

        //Phone
        nCell = nRow.createCell(5);
        nCell.setCellValue(printMap.get(&quot;Phone&quot;));
        nCell.setCellStyle(poiUtil.titlev12(wb, blackFont));

        //importNum
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(24);

        region = new CellRangeAddress(curRow-1, curRow-1, 1, 3);    //纵向合并单元格 
        sheet.addMergedRegion(region);

        nCell = nRow.createCell(1);
        nCell.setCellValue(&quot;产品&quot;);
        nCell.setCellStyle(thStyle(wb));        

        nCell = nRow.createCell(2);
        nCell.setCellStyle(poiUtil.notehv10_BorderThin(wb, defaultFont10));

        nCell = nRow.createCell(3);
        nCell.setCellStyle(poiUtil.notehv10_BorderThin(wb, defaultFont10));

        nCell = nRow.createCell(4);
        nCell.setCellValue(printMap.get(&quot;ContractDesc&quot;));
        nCell.setCellStyle(thStyle(wb));    

        region = new CellRangeAddress(curRow-1, curRow-1, 5, 6);    //纵向合并单元格 
        sheet.addMergedRegion(region);

        nCell = nRow.createCell(5);
        nCell.setCellValue(&quot;数量&quot;);
        nCell.setCellStyle(thStyle(wb));    

        nCell = nRow.createCell(6);
        nCell.setCellStyle(poiUtil.notehv10_BorderThin(wb, defaultFont10));            

        nCell = nRow.createCell(7);
        nCell.setCellValue(&quot;单价&quot;);
        nCell.setCellStyle(thStyle(wb));                        

        nCell = nRow.createCell(8);
        nCell.setCellValue(&quot;总金额&quot;);
        nCell.setCellStyle(thStyle(wb));                        


        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(96);

        region = new CellRangeAddress(curRow-1, curRow-1, 1, 3);    //纵向合并单元格 
        sheet.addMergedRegion(region);

        //插入产品图片
        if(UtilFuns.isNotEmpty(printMap.get(&quot;ProductImage&quot;))){
            System.out.println(printMap.get(&quot;ProductImage&quot;));
            poiUtil.setPicture(wb, patriarch, path+&quot;ufiles/jquery/&quot;+printMap.get(&quot;ProductImage&quot;), curRow-1, 1, curRow, 3);
        }

        nCell = nRow.createCell(2);
        nCell.setCellStyle(poiUtil.notehv10_BorderThin(wb, defaultFont10));

        nCell = nRow.createCell(3);
        nCell.setCellStyle(poiUtil.notehv10_BorderThin(wb, defaultFont10));

        //ProductDesc
        region = new CellRangeAddress(curRow-1, curRow, 4, 4);    //纵向合并单元格 
        sheet.addMergedRegion(region);

        nCell = nRow.createCell(4);
        nCell.setCellValue(printMap.get(&quot;ProductDesc&quot;));
        nCell.setCellStyle(poiUtil.notehv10_BorderThin(wb, defaultFont10));        

        //Cnumber
        region = new CellRangeAddress(curRow-1, curRow, 5, 5);    //纵向合并单元格 
        sheet.addMergedRegion(region);

        nCell = nRow.createCell(5);
        nCell.setCellType(HSSFCell.CELL_TYPE_NUMERIC);
        nCell.setCellValue(Double.parseDouble(printMap.get(&quot;Cnumber&quot;)));
        nCell.setCellStyle(poiUtil.numberrv10_BorderThin(wb, defaultFont10));    

        //Unit
        region = new CellRangeAddress(curRow-1, curRow, 6, 6);    //纵向合并单元格 
        sheet.addMergedRegion(region);

        nCell = nRow.createCell(6);
        nCell.setCellValue(printMap.get(&quot;PackingUnit&quot;));
        nCell.setCellStyle(poiUtil.moneyrv10_BorderThin(wb, defaultFont10, rmb4Format));    

        //Price
        region = new CellRangeAddress(curRow-1, curRow, 7, 7);    //纵向合并单元格 
        sheet.addMergedRegion(region);

        nCell = nRow.createCell(7);
        nCell.setCellType(HSSFCell.CELL_TYPE_NUMERIC);
        nCell.setCellValue(Double.parseDouble(printMap.get(&quot;Price&quot;)));
        nCell.setCellStyle(poiUtil.moneyrv10_BorderThin(wb, defaultFont10, rmb4Format));


        //Amount
        region = new CellRangeAddress(curRow-1, curRow, 8, 8);    //纵向合并单元格 
        sheet.addMergedRegion(region);

        nCell = nRow.createCell(8);
        if(UtilFuns.isNotEmpty(printMap.get(&quot;Cnumber&quot;)) &amp;&amp; UtilFuns.isNotEmpty(printMap.get(&quot;Price&quot;))){
            nCell.setCellType(HSSFCell.CELL_TYPE_FORMULA);
            nCell.setCellFormula(&quot;F&quot;+String.valueOf(curRow)+&quot;*H&quot;+String.valueOf(curRow));
        }
        nCell.setCellStyle(poiUtil.moneyrv10_BorderThin(wb, defaultFont10, rmb4Format));            

        curRow++;

        region = new CellRangeAddress(curRow-1, curRow-1, 1, 3);    //纵向合并单元格 
        sheet.addMergedRegion(region);

        //ProductNo
        nRow = sheet.createRow(curRow-1);
        nRow.setHeightInPoints(24);

        nCell = nRow.createCell(1);
        nCell.setCellValue(printMap.get(&quot;ProductNo&quot;));
        nCell.setCellStyle(poiUtil.notecv10_BorderThin(wb, defaultFont10));

        for(int j=2;j&lt;9;j++){
            nCell = nRow.createCell(j);
            nCell.setCellStyle(poiUtil.notehv10_BorderThin(wb, defaultFont10));
        }



        if(contract.getPrintStyle().equals(&quot;2&quot;) &amp;&amp; UtilFuns.isNotEmpty(printMap.get(&quot;ProductNo2&quot;))){
            nRow = sheet.createRow(curRow++);
            nRow.setHeightInPoints(96);

            region = new CellRangeAddress(curRow-1, curRow-1, 1, 3);    //纵向合并单元格 
            sheet.addMergedRegion(region);

            //插入产品图片
            if(UtilFuns.isNotEmpty(printMap.get(&quot;ProductImage2&quot;))){
                System.out.println(printMap.get(&quot;ProductImage2&quot;));
                poiUtil.setPicture(wb, patriarch, path+&quot;ufiles/jquery/&quot;+printMap.get(&quot;ProductImage2&quot;), curRow-1, 1, curRow, 3);
            }

            //ProductDesc
            region = new CellRangeAddress(curRow-1, curRow, 4, 4);    //纵向合并单元格 
            sheet.addMergedRegion(region);

            nCell = nRow.createCell(4);
            nCell.setCellValue(printMap.get(&quot;ProductDesc2&quot;));
            nCell.setCellStyle(poiUtil.notehv10_BorderThin(wb, defaultFont10));        

            //Cnumber
            region = new CellRangeAddress(curRow-1, curRow, 5, 5);    //纵向合并单元格 
            sheet.addMergedRegion(region);

            nCell = nRow.createCell(5);
            nCell.setCellType(HSSFCell.CELL_TYPE_NUMERIC);
            nCell.setCellValue(Double.parseDouble(printMap.get(&quot;Cnumber2&quot;)));
            nCell.setCellStyle(poiUtil.numberrv10_BorderThin(wb, defaultFont10));    

            //Unit
            region = new CellRangeAddress(curRow-1, curRow, 6, 6);    //纵向合并单元格 
            sheet.addMergedRegion(region);

            nCell = nRow.createCell(6);
            nCell.setCellValue(printMap.get(&quot;PackingUnit2&quot;));
            nCell.setCellStyle(poiUtil.moneyrv10_BorderThin(wb, defaultFont10, rmb4Format));    

            //Price
            region = new CellRangeAddress(curRow-1, curRow, 7, 7);    //纵向合并单元格 
            sheet.addMergedRegion(region);

            nCell = nRow.createCell(7);
            nCell.setCellType(HSSFCell.CELL_TYPE_NUMERIC);
            nCell.setCellValue(Double.parseDouble(printMap.get(&quot;Price2&quot;)));
            nCell.setCellStyle(poiUtil.moneyrv10_BorderThin(wb, defaultFont10, rmb4Format));


            //Amount
            region = new CellRangeAddress(curRow-1, curRow, 8, 8);    //纵向合并单元格 
            sheet.addMergedRegion(region);

            nCell = nRow.createCell(8);
            if(UtilFuns.isNotEmpty(printMap.get(&quot;Cnumber2&quot;)) &amp;&amp; UtilFuns.isNotEmpty(printMap.get(&quot;Price2&quot;))){
                nCell.setCellType(HSSFCell.CELL_TYPE_FORMULA);
                nCell.setCellFormula(&quot;F&quot;+String.valueOf(curRow)+&quot;*H&quot;+String.valueOf(curRow));
            }
            nCell.setCellStyle(poiUtil.moneyrv10_BorderThin(wb, defaultFont10, rmb4Format));        

            curRow++;

            region = new CellRangeAddress(curRow-1, curRow-1, 1, 3);    //纵向合并单元格
            sheet.addMergedRegion(region);

            nRow = sheet.createRow(curRow-1);
            nRow.setHeightInPoints(24);

            nCell = nRow.createCell(1);
            nCell.setCellValue(printMap.get(&quot;ProductNo2&quot;));
            nCell.setCellStyle(poiUtil.notecv10_BorderThin(wb, defaultFont10));            

            //合并单元格画线
            for(int j=2;j&lt;9;j++){
                nCell = nRow.createCell(j);
                nCell.setCellStyle(poiUtil.notehv10_BorderThin(wb, defaultFont10));
            }                
        }


        //InputBy
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(24);

        nCell = nRow.createCell(1);
        nCell.setCellValue(printMap.get(&quot;InputBy&quot;));
        nCell.setCellStyle(poiUtil.bnormalv12(wb,defaultFont12));

        //CheckBy+inspector

        nCell = nRow.createCell(4);
        nCell.setCellValue(printMap.get(&quot;CheckBy&quot;));
        nCell.setCellStyle(poiUtil.bnormalv12(wb,defaultFont12));

        //if(contract.getPrintStyle().equals(&quot;2&quot;) &amp;&amp; UtilFuns.isNotEmpty(printMap.get(&quot;ProductNo2&quot;))){

            nCell = nRow.createCell(7);
            nCell.setCellValue(&quot;总金额：&quot;);
            nCell.setCellStyle(bcv12(wb));

            //TotalAmount
            nRow = sheet.createRow(curRow-1);
            nRow.setHeightInPoints(24);
            if(UtilFuns.isNotEmpty(printMap.get(&quot;Cnumber&quot;))&amp;&amp;UtilFuns.isNotEmpty(printMap.get(&quot;Price&quot;))){
                nCell  = nRow.createCell(8);
                nCell.setCellType(HSSFCell.CELL_TYPE_FORMULA);
                nCell.setCellFormula(&quot;SUM(I&quot;+String.valueOf(curRow-4)+&quot;:I&quot;+String.valueOf(curRow-1)+&quot;)&quot;);
                nCell.setCellStyle(poiUtil.moneyrv12_BorderThin(wb,defaultFont12,rmb2Format));        
            }
        //}


        //note
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(21);

        nCell = nRow.createCell(2);
        nCell.setCellValue(printMap.get(&quot;Remark&quot;));
        nCell.setCellStyle(noteStyle(wb));            

        //Request
        region = new CellRangeAddress(curRow, curRow, 1, 8);    //指定合并区域 
        sheet.addMergedRegion(region);

        nRow = sheet.createRow(curRow++);
        float height = poiUtil.getCellAutoHeight(printMap.get(&quot;Request&quot;), 12f);        //自动高度
        nRow.setHeightInPoints(height);

        nCell = nRow.createCell(1);
        nCell.setCellValue(printMap.get(&quot;Request&quot;));
        nCell.setCellStyle(requestStyle(wb));

        //space line
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(20);

        //duty
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(32);

        nCell = nRow.createCell(1);
        nCell.setCellValue(&quot;未按以上要求出货而导致客人索赔，由供方承担。&quot;);
        nCell.setCellStyle(dutyStyle(wb));    

        //space line
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(32);

        //buyer
        nRow = sheet.createRow(curRow++);
        nRow.setHeightInPoints(25);

        nCell = nRow.createCell(1);
        nCell.setCellValue(&quot;    收购方负责人：&quot;);
        nCell.setCellStyle(dutyStyle(wb));                

        //seller
        nCell = nRow.createCell(5);
        nCell.setCellValue(&quot;供方负责人：&quot;);
        nCell.setCellStyle(dutyStyle(wb));    

        curRow++;

    }

    ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();            //生成流对象
    wb.write(byteArrayOutputStream);                                                    //将excel写入流

    //工具类，封装弹出下载框：        
    String outFile = &quot;购销合同.xls&quot;;
    DownloadUtil down = new DownloadUtil();
    down.download(byteArrayOutputStream, response, outFile);

}

private HSSFCellStyle leftStyle(HSSFWorkbook wb){
    HSSFCellStyle curStyle = wb.createCellStyle();
    curStyle.setWrapText(true);                          //换行   
    HSSFFont curFont = wb.createFont();                    //设置字体
    curFont.setCharSet(HSSFFont.DEFAULT_CHARSET);        //设置中文字体，那必须还要再对单元格进行编码设置
    //fTitle.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);    //加粗
    curFont.setFontHeightInPoints((short)10);
    curStyle.setFont(curFont);
    curStyle.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER);        //单元格垂直居中

    curStyle.setBorderLeft(HSSFCellStyle.BORDER_THIN);                //实线右边框
    curStyle.setBorderBottom(HSSFCellStyle.BORDER_THIN);                //实线右边框

    return curStyle;
}  

private HSSFCellStyle headStyle(HSSFWorkbook wb){
    HSSFCellStyle curStyle = wb.createCellStyle();
    HSSFFont curFont = wb.createFont();                    //设置字体
    curFont.setFontName(&quot;Comic Sans MS&quot;);
    curFont.setCharSet(HSSFFont.DEFAULT_CHARSET);        //设置中文字体，那必须还要再对单元格进行编码设置

    curFont.setItalic(true);
    curFont.setFontHeightInPoints((short)16);
    curStyle.setFont(curFont);
    curStyle.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER);        //单元格垂直居中

    return curStyle;
}  

private HSSFCellStyle tipStyle(HSSFWorkbook wb){
    HSSFCellStyle curStyle = wb.createCellStyle();
    HSSFFont curFont = wb.createFont();                    //设置字体
    curFont.setFontName(&quot;Georgia&quot;);
    curFont.setCharSet(HSSFFont.DEFAULT_CHARSET);        //设置中文字体，那必须还要再对单元格进行编码设置

    curFont.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);    //加粗
    curFont.setFontHeightInPoints((short)28);
    curStyle.setFont(curFont);
    curStyle.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER);        //单元格垂直居中

    return curStyle;
}  

private HSSFCellStyle addressStyle(HSSFWorkbook wb){
    HSSFCellStyle curStyle = wb.createCellStyle();
    HSSFFont curFont = wb.createFont();                    //设置字体
    curFont.setFontName(&quot;宋体&quot;);
    curFont.setCharSet(HSSFFont.DEFAULT_CHARSET);        //设置中文字体，那必须还要再对单元格进行编码设置

    //fTitle.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);    //加粗
    curFont.setFontHeightInPoints((short)10);
    curStyle.setFont(curFont);
    curStyle.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER);        //单元格垂直居中

    return curStyle;
}  

private HSSFCellStyle ltdStyle(HSSFWorkbook wb){
    HSSFCellStyle curStyle = wb.createCellStyle();
    HSSFFont curFont = wb.createFont();                    //设置字体
    curFont.setFontName(&quot;Times New Roman&quot;);
    curFont.setCharSet(HSSFFont.DEFAULT_CHARSET);        //设置中文字体，那必须还要再对单元格进行编码设置

    curFont.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);    //加粗
    curFont.setItalic(true);
    curFont.setFontHeightInPoints((short)16);
    curStyle.setFont(curFont);
    curStyle.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER);        //单元格垂直居中

    return curStyle;
}     

private HSSFCellStyle telStyle(HSSFWorkbook wb){
    HSSFCellStyle curStyle = wb.createCellStyle();
    HSSFFont curFont = wb.createFont();                    //设置字体
    curFont.setFontName(&quot;宋体&quot;);
    curFont.setCharSet(HSSFFont.DEFAULT_CHARSET);        //设置中文字体，那必须还要再对单元格进行编码设置

    //fTitle.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);    //加粗
    curFont.setFontHeightInPoints((short)9);
    curStyle.setFont(curFont);
    curStyle.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER);        //单元格垂直居中

    return curStyle;
}     

private HSSFCellStyle titleStyle(HSSFWorkbook wb){
    HSSFCellStyle curStyle = wb.createCellStyle();
    HSSFFont curFont = wb.createFont();                    //设置字体
    curFont.setFontName(&quot;黑体&quot;);
    curFont.setCharSet(HSSFFont.DEFAULT_CHARSET);        //设置中文字体，那必须还要再对单元格进行编码设置

    curFont.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);    //加粗
    curFont.setFontHeightInPoints((short)18);
    curStyle.setFont(curFont);
    curStyle.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER);        //单元格垂直居中

    return curStyle;
}     

private HSSFCellStyle requestStyle(HSSFWorkbook wb){
    HSSFCellStyle curStyle = wb.createCellStyle();
    curStyle.setWrapText(true);                          //换行   
    HSSFFont curFont = wb.createFont();                    //设置字体
    curFont.setFontName(&quot;宋体&quot;);
    curFont.setCharSet(HSSFFont.DEFAULT_CHARSET);        //设置中文字体，那必须还要再对单元格进行编码设置

    curFont.setFontHeightInPoints((short)10);
    curStyle.setFont(curFont);
    curStyle.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER);        //单元格垂直居中

    return curStyle;
}     

private HSSFCellStyle dutyStyle(HSSFWorkbook wb){
    HSSFCellStyle curStyle = wb.createCellStyle();
    HSSFFont curFont = wb.createFont();                    //设置字体
    curFont.setFontName(&quot;黑体&quot;);
    curFont.setCharSet(HSSFFont.DEFAULT_CHARSET);        //设置中文字体，那必须还要再对单元格进行编码设置

    curFont.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);    //加粗
    curFont.setFontHeightInPoints((short)16);
    curStyle.setFont(curFont);
    curStyle.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER);        //单元格垂直居中

    return curStyle;
}     

private HSSFCellStyle noteStyle(HSSFWorkbook wb){
    HSSFCellStyle curStyle = wb.createCellStyle();
    HSSFFont curFont = wb.createFont();                    //设置字体
    curFont.setFontName(&quot;宋体&quot;);
    curFont.setCharSet(HSSFFont.DEFAULT_CHARSET);        //设置中文字体，那必须还要再对单元格进行编码设置

    curFont.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);    //加粗
    curFont.setFontHeightInPoints((short)12);
    curStyle.setFont(curFont);
    curStyle.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER);        //单元格垂直居中

    return curStyle;
} 

public HSSFCellStyle thStyle(HSSFWorkbook wb){
    HSSFCellStyle curStyle = wb.createCellStyle();
    HSSFFont curFont = wb.createFont();                    //设置字体
    curFont.setFontName(&quot;宋体&quot;);
    curFont.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);    //加粗
    curFont.setFontHeightInPoints((short)12);
    curFont.setCharSet(HSSFFont.DEFAULT_CHARSET);        //设置中文字体，那必须还要再对单元格进行编码设置

    curStyle.setBorderTop(HSSFCellStyle.BORDER_THIN);                //实线右边框
    curStyle.setBorderRight(HSSFCellStyle.BORDER_THIN);                //实线右边框
    curStyle.setBorderBottom(HSSFCellStyle.BORDER_THIN);            //实线右边框
    curStyle.setBorderLeft(HSSFCellStyle.BORDER_THIN);                //实线右边框

    curStyle.setAlignment(HSSFCellStyle.ALIGN_CENTER);
    curStyle.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER);        //单元格垂直居中

    return curStyle;
}  

public HSSFCellStyle bcv12(HSSFWorkbook wb){
    HSSFCellStyle curStyle = wb.createCellStyle();
    HSSFFont curFont = wb.createFont();                        //设置字体
    curFont.setFontName(&quot;Times New Roman&quot;);
    curFont.setCharSet(HSSFFont.DEFAULT_CHARSET);            //设置中文字体，那必须还要再对单元格进行编码设置

    curFont.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);        //加粗
    curFont.setFontHeightInPoints((short)12);
    curStyle.setFont(curFont);

    curStyle.setBorderTop(HSSFCellStyle.BORDER_THIN);                //实线
    curStyle.setBorderRight(HSSFCellStyle.BORDER_THIN);            //粗实线
    curStyle.setBorderBottom(HSSFCellStyle.BORDER_THIN);            //实线
    curStyle.setBorderLeft(HSSFCellStyle.BORDER_THIN);                //实线

    curStyle.setAlignment(HSSFCellStyle.ALIGN_RIGHT);
    curStyle.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER);        //单元格垂直居中

    return curStyle;
}        

}
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/25/jk5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="FangChao.Qu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/touxiangImg.JPG">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FangChao.Qu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/25/jk5/" itemprop="url">
                  基于SSM的商贸平台项目（第五天）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-25T09:26:46+08:00">
                2017-05-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-POI解决什么问题"><a href="#1-POI解决什么问题" class="headerlink" title="1.POI解决什么问题"></a>1.POI解决什么问题</h1><p>JXL，POI都是操作excel<br>Excel一些企业小的应用都直接用excel来实现，例如：工资报表，人员名单，进销存<br>作为数据的备份和恢复（导入、导出）</p>
<p>Jxl 它只能操作excel 2003版本，它导入导出数据量小时性能很高<br>POI 它可以操作office系列软件word、excel、ppt、visio(画网络布局、家装)，在早期版本中它在导出海量数据时，容易崩溃。在新版本中它解决了这个海量数据时，进行了优化，解决了这个问题。</p>
<h1 id="2-POI初体验"><a href="#2-POI初体验" class="headerlink" title="2.POI初体验"></a>2.POI初体验</h1><pre><code>@Test
public void testHSSF_base() throws IOException{
    /*
     * 开发步骤：
     * 1、创建一个工作簿
     * 2、创建一个工作表
     * 3、创建一个行对象
     * 4、创建一个单元格对象，指定它的列
     * 5、给单元格设置内容
     * 6、样式进行修饰（跳过）
     * 7、保存，写文件
     * 8、关闭对象
     */

    Workbook wb = new HSSFWorkbook();
    Sheet sheet = wb.createSheet();
    Row nRow = sheet.createRow(7);            //第八行
    Cell nCell = nRow.createCell(4);        //第五列

    nCell.setCellValue(&quot;传智播客万年长！&quot;);

    OutputStream os = new FileOutputStream(&quot;c:\\testpoi.xls&quot;);    //excel 2003
    wb.write(os);

    os.flush();
    os.close();
}
</code></pre><h2 id="2-1小结"><a href="#2-1小结" class="headerlink" title="2.1小结"></a>2.1小结</h2><p>Poi本身操作极其简单，只要记住使用的api即可。<br>但是它在处理单元格时<br>1）    不能直接看中间结果，必须运行完才可以看到<br>2）    HSSF构造的对象都在内存中，创建非常多的对象，当对象量越来越多时，容易造成堆溢出。</p>
<h1 id="3-POI模板开发"><a href="#3-POI模板开发" class="headerlink" title="3.POI模板开发"></a>3.POI模板开发</h1><p><img src="/images/51.png" alt="Alt text"></p>
<pre><code>InputStream is = new FileInputStream(new File(&quot;c:\\tOUTPRODUCT.xls&quot;));
Workbook wb = new HSSFWorkbook(is);        //打开一个模板文件，工作簿
Sheet sheet = wb.getSheetAt(0);            //获取到第一个工作表

Row nRow = null;
Cell nCell = null;
int rowNo = 0;                            //行号
int colNo = 1;                            //列号

//获取模板上的单元格样式
nRow = sheet.getRow(2);

//客户的样式
nCell = nRow.getCell(1);
CellStyle customStyle = nCell.getCellStyle();    
</code></pre><h1 id="4-POI百万数据打印"><a href="#4-POI百万数据打印" class="headerlink" title="4.POI百万数据打印"></a>4.POI百万数据打印</h1><ol>
<li>从数据库读取数据，LIST在构造时十分耗费内存，还占用CPU资源</li>
<li>Xlsx一个单sheet可以支持1048576条数据。它加工这些数据时，都是暂时放在内存中。报内存堆溢出。</li>
<li>POI意识到这个问题，它在高版本解决了海量数据导出时性能问题。可以实现非常平滑的导出。</li>
</ol>
<h2 id="4-1解决方法"><a href="#4-1解决方法" class="headerlink" title="4.1解决方法"></a>4.1解决方法</h2><h3 id="4-1-1-POI-ooxml-SXSSF对象"><a href="#4-1-1-POI-ooxml-SXSSF对象" class="headerlink" title="4.1.1 POI ooxml SXSSF对象"></a>4.1.1 POI ooxml SXSSF对象</h3><pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
    &lt;artifactId&gt;poi&lt;/artifactId&gt;
    &lt;version&gt;3.9&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
    &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;
    &lt;version&gt;3.9&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><h3 id="4-1-2-它解决思路："><a href="#4-1-2-它解决思路：" class="headerlink" title="4.1.2 它解决思路："></a>4.1.2 它解决思路：</h3><p>在打印过程中，已经加工完的对象，临时存到一个临时文件中，它采用xml临时文件。最终处理完时，将这些临时内容写入到最终的xlsx文件中。</p>
<pre><code>Workbook wb = new SXSSFWorkbook(100);    //创建excel文件，内存只有100条记录【关键语句】
public SXSSFWorkbook(int rowAccessWindowSize){
this(null /*workbook*/, rowAccessWindowSize);
</code></pre><p>}<br>每rowAccessWindowSize条对象时，写一次缓存。</p>
<p>！！！！ 这个对象不能使用模板。只能用于到数据量的导出。（没有格式）</p>
<h1 id="5-CSV文件，导入到数据库中"><a href="#5-CSV文件，导入到数据库中" class="headerlink" title="5.    CSV文件，导入到数据库中"></a>5.    CSV文件，导入到数据库中</h1><p>CSV是一个标准的导入导出文件格式，实际是一个txt文件</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>


          
          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/touxiangImg.JPG"
               alt="FangChao.Qu" />
          <p class="site-author-name" itemprop="name">FangChao.Qu</p>
           
              <p class="site-description motion-element" itemprop="description">所有人都在努力，并不是只有你满腹委屈</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/oucqfc" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/3309933097" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">FangChao.Qu</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  

  

  

  

  


  

</body>
</html>
